from ROOT import *

Samples_2016_BH_MET = {
  '2016B' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0005/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180207/180208_015835/0006/out_ana*.root",
    ], 
  '2016C' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180207/180208_015852/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180207/180208_015852/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180207/180208_015852/0002/out_ana*.root",
    ],
  '2016D' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180207/180208_015908/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180207/180208_015908/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180207/180208_015908/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180207/180208_015908/0003/out_ana*.root",
    ],
  '2016E' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180207/180208_015927/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180207/180208_015927/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180207/180208_015927/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180207/180208_015927/0003/out_ana*.root",
    ],
  '2016F' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180207/180208_015944/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180207/180208_015944/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180207/180208_015944/0002/out_ana*.root",
    ],
  '2016G' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180207/180208_020000/0005/out_ana*.root",
    ],
  '2016H' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180207/180208_020016/0005/out_ana*.root",
    ],
  }


def makeSkim(era, date="20180208"):

  chain = TChain("cutFlowAnalyzerPXBL3PXFL2/Events");

  for p in Samples_2016_BH_MET[era]:
      chain.Add(p)
      print p

  ## save to file
  newFile = TFile.Open("out_ana_selected_MET_" + era + "_" + date + ".root","RECREATE") 
  newChain = chain.CopyTree("nRecoMu>=3")
  newChain.AutoSave()
  newFile.Close()

  print "Processed", era


def makeSkims():

  for p in Samples_2016_BH_MET:
      makeSkim(p)

makeSkims()




