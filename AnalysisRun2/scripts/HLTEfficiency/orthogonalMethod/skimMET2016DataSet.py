from ROOT import *

Samples_2016_BH_MET = {
  '2016B' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0005/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-23Sep2016-v3-20170928/170928_192711/0006/out_ana*.root",
    ], 
  '2016C' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-23Sep2016-v1-20170928/170928_192733/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-23Sep2016-v1-20170928/170928_192733/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-23Sep2016-v1-20170928/170928_192733/0002/out_ana*.root",
    ],
  '2016D' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-23Sep2016-v1-20170928/170928_192753/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-23Sep2016-v1-20170928/170928_192753/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-23Sep2016-v1-20170928/170928_192753/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-23Sep2016-v1-20170928/170928_192753/0003/out_ana*.root",
    ],
  '2016E' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-23Sep2016-v1-20170928/170928_192817/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-23Sep2016-v1-20170928/170928_192817/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-23Sep2016-v1-20170928/170928_192817/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-23Sep2016-v1-20170928/170928_192817/0003/out_ana*.root",
    ],
  '2016F' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-23Sep2016-v1-20170928/170928_192840/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-23Sep2016-v1-20170928/170928_192840/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-23Sep2016-v1-20170928/170928_192840/0002/out_ana*.root",
    ],
  '2016G' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-23Sep2016-v1-20170928/170928_192901/0005/out_ana*.root",
    ],
  '2016H' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v2-20170928/170928_192947/0005/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-PromptReco-v3-20170928/170928_193007/0000/out_ana*.root",
    ],
  }

def makeSkim(era, date="20171006"):

  chain = TChain("cutFlowAnalyzer_Data/Events");

  for p in Samples_2016_BH_MET[era]:
      chain.Add(p)
      print p

  ## save to file
  newFile = TFile.Open("out_ana_selected_MET_" + era + "_" + date + ".root","RECREATE") 
  newChain = chain.CopyTree("nRecoMu>=3")
  newChain.AutoSave()
  newFile.Close()

  print "Processed", era


def makeSkims():

  for p in Samples_2016_BH_MET:
      makeSkim(p)

makeSkims()
