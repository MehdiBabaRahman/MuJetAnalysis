from ROOT import *

Samples_2016_BH_MET = {
  '2016B' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0005/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016B-07Aug17_ver2-v1-20180111/180112_053127/0006/out_ana*.root",
    ], 
  '2016C' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180111/180112_053143/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180111/180112_053143/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016C-07Aug17-v1-20180111/180112_053143/0002/out_ana*.root",
    ],
  '2016D' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180111/180112_053200/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180111/180112_053200/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180111/180112_053200/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016D-07Aug17-v1-20180111/180112_053200/0003/out_ana*.root",
    ],
  '2016E' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180111/180112_053219/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180111/180112_053219/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180111/180112_053219/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016E-07Aug17-v1-20180111/180112_053219/0003/out_ana*.root",
    ],
  '2016F' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180111/180112_053236/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180111/180112_053236/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016F-07Aug17-v1-20180111/180112_053236/0002/out_ana*.root",
    ],
  '2016G' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016G-07Aug17-v1-20180111/180112_053253/0005/out_ana*.root",
    ],
  '2016H' : [
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0000/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0001/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0002/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0003/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0004/out_ana*.root",
    "/fdata/hepx/store/user/dildick/MET/crab_MET-Run2016H-07Aug17-v1-20180111/180112_053309/0005/out_ana*.root"
    ],
  }

def makeSkim(era, date="20180112"):

  chain = TChain("cutFlowAnalyzerPXBL3PXFL2/Events");

  for p in Samples_2016_BH_MET[era]:
      chain.Add(p)
      print p

  ## save to file
  newFile = TFile.Open("out_ana_selected_MET_" + era + "_" + date + ".root","RECREATE") 
  newChain = chain.CopyTree("nRecoMu>=3")
  newChain.AutoSave()
  newFile.Close()

  print "Processed", era


def makeSkims():

  for p in Samples_2016_BH_MET:
      makeSkim(p)

makeSkims()




